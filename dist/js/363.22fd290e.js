"use strict";(self["webpackChunkvue3_operation"]=self["webpackChunkvue3_operation"]||[]).push([[363],{9363:function(t,s,e){e.r(s),e.d(s,{default:function(){return N}});var o=e(3396),l=e(7139),a=e(9242);const i={class:"container"},n={class:"row mt-4"},d={class:"col-md-7"},c={class:"table align-middle"},r=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"圖片"),(0,o._)("th",null,"商品名稱"),(0,o._)("th",null,"價格"),(0,o._)("th")])],-1),u={style:{width:"200px"}},p={href:"#",class:"text-dark"},h={key:0,class:"h5"},g={key:1,class:"h6"},_={key:2,class:"h5"},m={class:"btn-group btn-group-sm"},b=["onClick"],y=["disabled","onClick"],k={key:0,class:"spinner-grow text-danger spinner-border-sm",role:"status"},v=(0,o._)("span",{class:"visually-hidden"},"Loading...",-1),w=[v],C=(0,o.Uk)(" 加到購物車 "),x={class:"col-md-5"},f={class:"sticky-top"},D={class:"table align-middle"},$=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th"),(0,o._)("th",null,"品名"),(0,o._)("th",{style:{width:"110px"}},"數量"),(0,o._)("th",null,"單價")])],-1),I=["disabled","onClick"],q=(0,o._)("i",{class:"bi bi-x"},null,-1),z=[q],M={key:0,class:"text-success"},P={class:"input-group input-group-sm"},L=["disabled","onChange","onUpdate:modelValue"],U={class:"input-group-text"},j={class:"text-end"},H={key:0,class:"text-success"},V=(0,o._)("td",{colspan:"3",class:"text-end"},"總計",-1),Y={class:"text-end"},K={key:0},Z=(0,o._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),S={class:"text-end text-success"},W={class:"input-group mb-3 input-group-sm"},A={class:"input-group-append"};function B(t,s,e,v,q,B){const E=(0,o.up)("DelModal");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",i,[(0,o._)("div",n,[(0,o._)("div",d,[(0,o._)("table",c,[r,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(q.products,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",u,[(0,o._)("div",{style:(0,l.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),(0,o._)("td",null,[(0,o._)("a",p,(0,l.zw)(t.title),1)]),(0,o._)("td",null,[t.price?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",h,(0,l.zw)(t.origin_price)+" 元",1)),t.price?((0,o.wg)(),(0,o.iD)("del",g,"原價 "+(0,l.zw)(t.origin_price)+" 元",1)):(0,o.kq)("",!0),t.price?((0,o.wg)(),(0,o.iD)("div",_,"現在只要 "+(0,l.zw)(t.price)+" 元",1)):(0,o.kq)("",!0)]),(0,o._)("td",null,[(0,o._)("div",m,[(0,o._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:s=>B.getProduct(t.id)}," 查看更多 ",8,b),(0,o._)("button",{type:"button",class:"btn btn-outline-danger",disabled:this.status.loadingItem===t.id,onClick:s=>B.addCart(t.id)},[this.status.loadingItem===t.id?((0,o.wg)(),(0,o.iD)("div",k,w)):(0,o.kq)("",!0),C],8,y)])])])))),128))])])]),(0,o._)("div",x,[(0,o._)("div",f,[(0,o._)("table",D,[$,(0,o._)("tbody",null,[q.cart.carts?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)(q.cart.carts,(s=>((0,o.wg)(),(0,o.iD)("tr",{key:s.id},[(0,o._)("td",null,[(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:q.status.loadingItem===s.id,onClick:t=>B.removeCartItem(s.id)},z,8,I)]),(0,o._)("td",null,[(0,o.Uk)((0,l.zw)(s.product.title)+" ",1),s.coupon?((0,o.wg)(),(0,o.iD)("div",M," 已套用優惠券 ")):(0,o.kq)("",!0)]),(0,o._)("td",null,[(0,o._)("div",P,[(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",min:"1",disabled:q.status.loadingItem===s.id,onChange:t=>B.updateCart(s),"onUpdate:modelValue":t=>s.qty=t},null,40,L),[[a.nr,s.qty,void 0,{number:!0}]]),(0,o._)("div",U,"/ "+(0,l.zw)(s.product.unit),1)])]),(0,o._)("td",j,[q.cart.final_total!==q.cart.total?((0,o.wg)(),(0,o.iD)("small",H,"折扣價：")):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,l.zw)(t.$filters.currency(s.final_total)),1)])])))),128)):(0,o.kq)("",!0)]),(0,o._)("tfoot",null,[(0,o._)("tr",null,[V,(0,o._)("td",Y,(0,l.zw)(t.$filters.currency(q.cart.total)),1)]),q.cart.final_total!==q.cart.total?((0,o.wg)(),(0,o.iD)("tr",K,[Z,(0,o._)("td",S,(0,l.zw)(t.$filters.currency(q.cart.final_total)),1)])):(0,o.kq)("",!0)])]),(0,o._)("div",W,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>q.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[a.nr,q.coupon_code]]),(0,o._)("div",A,[(0,o._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[1]||(s[1]=(...s)=>t.addCouponCode&&t.addCouponCode(...s))}," 套用優惠碼 ")])])])])])]),(0,o.Wm)(E,{item:q.cart,ref:"delModal",onDelItem:B.delProduct},null,8,["item","onDelItem"])],64)}var E=e(4912),F={data(){return{products:[],product:{},status:{loadingItem:""},cart:{},coupon_code:"",isLoading:!1}},components:{DelModal:E.Z},methods:{getProducts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/jay-api/products/all";this.$http.get(t).then((t=>{this.isLoading=!1,this.products=t.data.products,console.log("products:",t)}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t){const s="https://vue3-course-api.hexschool.io/api/jay-api/cart";this.status.loadingItem=t;const e={product_id:t,qty:1};this.$http.post(s,{data:e}).then((t=>{this.$httpMessageState(t,"加入購物車"),this.status.loadingItem="",console.log(t)}))},getCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/jay-api/cart";this.$http.get(t).then((t=>{this.isLoading=!1,this.cart=t.data.data,console.log(t)}))},updateCart(t){this.isLoading=!0;const s=`https://vue3-course-api.hexschool.io/api/jay-api/cart/${t.id}`;this.status.loadingItem=t.id;const e={product_id:t.product_id,qty:t.qty};this.$http.put(s,{data:e}).then((t=>{console.log(t),this.status.loadingItem="",this.getCart()}))},removeCartItem(t){this.cart.product_id=t,console.log(this.cart.product_id),console.log("id:",t);const s=this.$refs.delModal;s.showModal()},delProduct(){const t=`https://vue3-course-api.hexschool.io/api/jay-api/admin/product/${this.tempProduct.id}`;this.$http.delete(t).then((t=>{const s=this.$refs.delModal;s.hideModal(),this.getProducts()}))}},created(){this.getProducts(),this.getCart()}},G=e(89);const J=(0,G.Z)(F,[["render",B]]);var N=J}}]);
//# sourceMappingURL=363.22fd290e.js.map